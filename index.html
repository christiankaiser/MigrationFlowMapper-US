
<!DOCTYPE html>
<html lang="en">
<head>
	
	<meta charset="UTF-8">
    <title>Curves on a leaflet map</title>
    

    <!-- Don't know what this does! It was added with the sidebar stuff. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- This gets icons used in the sidebar module. -->
	 <link  rel="stylesheet" href="resources/font-awesome-4.6.1/css/font-awesome.min.css">

    <!-- .css files. -->
    <link rel="stylesheet" href="styles/leaflet.css"/> 
    <link rel="stylesheet" href="styles/bootstrap.min.css"/>    
    <link rel="stylesheet" href="node_modules/leaflet-toolbar/dist/leaflet.toolbar.css"/>
    <link rel="stylesheet" href="node_modules/sidebar-v2/css/leaflet-sidebar.css" />
    
    <link rel="stylesheet" href="styles/floxStyle.css">
    
    
    <!--      Modules and plugins      -->
    <!-- ============================= -->

    <!-- d3 handles SVG manipulation data linking -->
    <script src="scripts/d3.min.js"></script>

	<!-- jQuery does neat things. It will surely be useful! -->
	<script src="lib/jQuery/jquery-1.12.3.js"></script>

    <!-- Leaflet provides the map and tile service -->
    <script src="scripts/leaflet.js"></script>

    <!-- Module for adding toolbars to the leaflet map -->
    <script src="node_modules/leaflet-toolbar/dist/leaflet.toolbar-src.js"></script>

    <!-- Leaflet sidebar module from https://github.com/turbo87/sidebar-v2/ -->
    <script src="node_modules/sidebar-v2/js/leaflet-sidebar.js"></script>    

	<script src="lib/DataTables/datatables.js" ></script>
	
	<script src="lib/bootstrap.js"></script>
	
	<script src="lib/leaflet-providers.js"></script>
	
</head>

<body>

	<!-- The sidebar div is set up here. -->
    <div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fa fa-share"></i></a></li>
                <li><a href="#appearance" role="tab"><i class="fa fa-map-o"></i></a></li>
                <li><a href="#data" role="tab"><i class="fa fa-table"></i></a></li>
                <li id="editTab"><a href="#sidebar-edit" role="tab"><i class="fa fa-edit"></i></a></li>
                <li><a href="#arrows" role="tab"><img src="resources/icons/Untitled-1.svg"/></a></li>
                
            </ul>

            <ul role="tablist">
                <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
            </ul>
        </div>

        <!-- Tab Panels -->
        <div class="sidebar-content">

            <!--============ Layout Setting Panel ============-->
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header"> 
                	Layout Settings
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>

                <!-- Start Sliders in the layout setting panel -->
                <p class="sliderLabel">Longest Flow Spring Stiffness</p>
                <input type="range" id="longestFlowSpringStiffnessSlider" 
                class="menuSlider" value="5" min="0" max="100" step="1"
                style="display: inline-block"
                oninput="Flox.longestFlowSpringStiffnessSliderOninput()">
                <p class="sliderOutputText" id="longestFlowSpringStiffnessSliderOutputText">0</p>

                <p class="sliderLabel">Shortest Flow Spring Stiffness</p>
                <input type="range" id="shortestFlowSpringStiffnessSlider" 
                class="menuSlider" value="50" min="0" max="500" step="1" 
                style="display: inline-block"
                oninput="Flox.shortestFlowSpringStiffnessSliderOninput()">
                <p class="sliderOutputText" id="shortestFlowSpringStiffnessSliderOutputText">0</p>

                <p class="sliderLabel">Distance Weight Exponent</p>
                <input type="range" id="distanceWeightExponentSlider" 
                class="menuSlider" value="3" min="1" max="4" step="1" 
                style="display: inline-block"
                oninput="Flox.distanceWeightExponentSliderOninput()">
                <p class="sliderOutputText" id="distanceWeightExponentSliderOutputText">0</p>

				<p class="sliderLabel">Repulsion of Start and End Nodes</p>
                <input type="range" id="nodeWeightSlider" 
                class="menuSlider" value="10" min="0" max="100" step="1" 
                style="display: inline-block"
                oninput="Flox.nodeWeightSliderOninput()">
                <p class="sliderOutputText" id="nodeWeightSliderOutputText">0</p>

                <p class="sliderLabel">Angular Distribution</p>
                <input type="range" id="angularDistributionSlider" 
                class="menuSlider" min="0" max="100" step="1" 
                style="display: inline-block"
                oninput="Flox.angularDistributionSliderOninput()">
                <p class="sliderOutputText" id="angularDistributionSliderOutputText">0</p>

                <p class="sliderLabel">Peripheral Flow Stiffness</p>
                <input type="range" id="peripheralFlowStiffnessSlider" 
                class="menuSlider" min="0" max="100" step="1"
                style="display: inline-block"
                oninput="Flox.peripheralFlowStiffnessSliderOninput()">
                <p class="sliderOutputText" id="peripheralFlowStiffnessSliderOutputText">0</p>

                <p class="sliderLabel">Anti-Torsion Force</p>
                <input type="range" id="antiTorsionSlider" 
                class="menuSlider" min="0" max="100" step="1"
                style="display: inline-block"
                oninput="Flox.antiTorsionSliderOninput()">
                <p class="sliderOutputText" id="antiTorsionSliderOutputText">0</p>

                <p class="sliderLabel">Flow Rangebox Height</p>
                <input type="range" id="flowRangeboxHeightSlider" 
                class="menuSlider" min="5" max="100" step="1" 
                style="display: inline-block;"
                oninput="Flox.flowRangeboxHeightSliderOninput(value)"
                onmousedown="Flox.flowRangeboxHeightSliderMousedown()"
                onmouseup="Flox.flowRangeboxHeightSliderMouseup()">
                <p class="sliderOutputText" id="flowRangeboxHeightSliderOutputText">0</p>
                
                <p class="sliderLabel">Min. Distance of Flows from Nodes</p>
                <input type="range" id="minDistOfFlowsFromNodesSlider" 
                class="menuSlider" min="0" max="100" step="1" 
                style="display: inline-block;"
                oninput="Flox.minDistOfFlowsFromNodesSliderOninput()">
                <p class="sliderOutputText" id="minDistOfFlowsFromNodesSliderOutputText">0</p>
                <!-- End Sliders in the layout setting panel -->

                <!-- Start Buttons in the layout setting panel -->
                <button type="button" id="layoutFlowsButton" 
                class="menuButton btn btn-default btn-block" 
                onclick="Flox.layoutFlows()">Run Flox.FlowLayouter</button>
                
                <button type="button" id="runLayoutWorkerButton" 
                class="menuButton btn btn-default btn-block" 
                onclick="Flox.runLayoutWorker()">Run layoutWorker</button>

                <button type="button" id="straightenFlowsButton" 
                class="menuButton btn btn-default btn-block" 
                onclick="Flox.straightenFlows()">Straighten Flows</button>
                <!-- End Buttons in the layout setting panel -->
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="checkFlowBoundingBoxesCheckbox" checked
                    	onclick="Flox.checkFlowBoundingBoxesCheckboxClicked()"> 
                    	Check Flow Bounding Boxes
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="skipEndPointsCheckbox">
                    	Skip End Points
                    </p>
                </div>
                
                <progress value="0" max="100" id="layoutProgressBar"
                style="visibility: hidden;">
				</progress>
                <!-- Progress Bar -->
            </div>

            <!--============ Map Appearance Panel ============-->
            <div class="sidebar-pane" id="appearance">
                <h1 class="sidebar-header"> Map Appearance
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>

                <p class="sliderLabel">Max Flow Width</p>
                <input type="range" id="maxFlowWidthSlider" class="menuSlider" 
                value="20" min="1.5" max="100" step="0.5" 
                style="display: inline-block"
                oninput="Flox.maxFlowWidthSliderOninput()">
                <p class="sliderOutputText" id="maxFlowWidthSliderOutputText">0</p>
				
                <p class="sliderLabel">Max Node Radius</p>
                <input type="range" id="maxNodeRadiusSlider" class="menuSlider"
                value="20" min="1.5" max="100" step="0.5" 
                style="display: inline-block"
                oninput="Flox.maxNodeRadiusSliderOninput()">
				<p class="sliderOutputText" id="maxNodeRadiusSliderOutputText">0</p>

				<p class="sliderLabel">Max Number of Flows</p>
                <input type="range" id="maxFlowsSlider" class="menuSlider"
                value="20" min="0" max="100" step="1" 
                style="display: inline-block">
				<p class="sliderOutputText" id="maxFlowsSliderOutputText">0</p>

				<div class="textInputHolder">
					Flow Distance From Start Point <br>
					<input type="text" id="flowDistanceFromStartPointTextBox"
					class="textInput form-control" value="0"
					onkeypress="Flox.flowDistanceFromStartPointTextBoxOnkeypress(event)"
					onblur = "Flox.updateFlowDistanceFromStartPointTextBox()">
				</div>
				
				<div class="textInputHolder">
					Flow Distance From End Point <br>
					<input type="text" id="flowDistanceFromEndPointTextBox"
					class="textInput form-control" value="0"
					onkeypress="Flox.flowDistanceFromEndPointTextBoxOnkeypress(event)"
					onblur = "Flox.updateFlowDistanceFromEndPointTextBox()">
				</div>

                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="showControlPointsCheckbox" 
                    	onclick="Flox.showControlPointsCheckboxClicked()"> 
                    	Show Control Points
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="showFlowPointsCheckbox" 
                    	onclick="Flox.showFlowPointsCheckboxClicked()"> 
                    	Show Flow Points
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="showRangeboxesCheckbox" 
                    	onclick="Flox.showRangeboxesCheckboxClicked()"> 
                    	Show Rangeboxes
                    </p>
                </div>
                
                <div class="selectorHolder">
				 Select Base Layer
				  <select class="form-control" id="baseLayerSelector">
				    <option class="baseLayerOption" value="gray_basemap" >ESRI Light Gray</option>
				    <option class="baseLayerOption" value="osmapnik_basemap">Open Street Maps</option>
				  </select>
				</div>
            </div>

			<!--============ Data Panel ============-->
            <div class="sidebar-pane" id="data">
                <h1 class="sidebar-header">Data
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>
                
                <div class="dropdown" style="margin-top: 5px; margin-bottom: 10px;">
				  <button class="menuButton btn btn-default btn-block dropdown-toggle" 
				  type="button" id="loadDataMenuButton" data-toggle="dropdown" 
				  aria-haspopup="true" aria-expanded="true">
				    Load Data
				    <span class="caret"></span>
				  </button>
				  <ul class="dropdown-menu" >
				    <li><a href="#" id="telecomMenuItem">European Telecommunications</a></li>
				    <li><a href="#" id="usBetweenStateMigrationMenuItem">U.S. Between-State Migration</a></li>
				    <li role="separator" class="divider"></li>
				    <li><a href="#" id="clearAllDataMenuItem">Clear All Data</a></li>
				  </ul>
				</div>
            
            	<div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="showNetFlowsCheckbox"> 
                    	Show Net Flows
                    </p>
                </div>
            
            </div>
            
			<!--============ Edit Panel ============-->
			<div class="sidebar-pane" id="sidebar-edit">
                <h1 class="sidebar-header">Edit
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>
                                
                <button type="button" style="margin-top: 5px;"
                class="menuButton btn btn-default btn-block" 
                id="deleteSelectedButton"
                onclick="Flox.deleteSelectedFeatures()">Delete Selected Features</button>
          
          		<div class="textInputHolder">
					Flow Value <br>
					<input type="text" id="flowValueTextBox"
					class="textInput form-control" value="">
				</div>
				
				<div class="textInputHolder">
					Flow Start Point <br>
					<input type="text" id="flowStartPointTextBox"
					class="textInput form-control" value="">
				</div>
				
				<div class="textInputHolder">
					Flow End Point <br>
					<input type="text" id="flowEndPointTextBox"
					class="textInput form-control" value="">
				</div>
            </div>
			
			<!--============ Arrow Settings Panel ============-->
            <div class="sidebar-pane" id="arrows">
                <h1 class="sidebar-header"> 
                	Arrow Settings
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="addArrowsCheckbox" 
                    	onclick="Flox.addArrowsCheckboxClicked()"> 
                    	Add Arrows
                    </p>
                </div>
                
                <p class="sliderLabel">Arrow Length</p>
                <input type="range" id="arrowLengthSlider" 
                class="menuSlider" value="1.6" min="0" max="20" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowLengthSliderOninput()">
                <p class="sliderOutputText" id="arrowLengthSliderOutputText">0</p>
                
                <p class="sliderLabel">Arrow Width</p>
                <input type="range" id="arrowWidthSlider" 
                class="menuSlider" value="0.8" min="0" max="20" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowWidthSliderOninput()">
                <p class="sliderOutputText" id="arrowWidthSliderOutputText">0</p>
                
                <p class="sliderLabel">Arrow Edge Ctrl Pt Length</p>
                <input type="range" id="arrowEdgeCtrlPointLengthSlider" 
                class="menuSlider" value="0.5" min="-3" max="4" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowEdgeCtrlPointLengthSliderOninput()">
                <p class="sliderOutputText" id="arrowEdgeCtrlPointLengthSliderOutputText">0</p>
                
                <p class="sliderLabel">Arrow Edge Ctrl Pt Width</p>
                <input type="range" id="arrowEdgeCtrlPointWidthSlider" 
                class="menuSlider" value="0.5" min="-3" max="4" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowEdgeCtrlPointWidthSliderOninput()">
                <p class="sliderOutputText" id="arrowEdgeCtrlPointWidthSliderOutputText">0</p>
                
                <p class="sliderLabel">Arrow Corner Position</p>
                <input type="range" id="arrowCornerPositionSlider" 
                class="menuSlider" value="0.0" min="-0.5" max="0.5" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowCornerPositionSliderOninput()">
                <p class="sliderOutputText" id="arrowCornerPositionSliderOutputText">0</p>
                
                <p class="sliderLabel">Minimum Arrow Size</p>
                <input type="range" id="arrowSizeRatioSlider" 
                class="menuSlider" value="0.1" min="0" max="1" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowSizeRatioSliderOninput()">
                <p class="sliderOutputText" id="arrowSizeRatioSliderOutputText">0</p>
                
                <p class="sliderLabel">Long Arrow Length?</p>
                <input type="range" id="arrowLengthRatioSlider" 
                class="menuSlider" value="0" min="0" max="1" step="0.01"
                style="display: inline-block"
                oninput="Flox.arrowLengthRatioSliderOninput()">
                <p class="sliderOutputText" id="arrowLengthRatioSliderOutputText">0</p>
            </div>

            <!--============ Settings Panel? ============-->
            <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Settings
                	<div class="sidebar-close">
                		<i class="fa fa-caret-right"></i>
                	</div>
                </h1>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="moveFlowsIntersectingNodesCheckbox" 
                    	onclick="Flox.moveFlowsIntersectingNodesCheckboxClicked()"> 
                    	Move Flows Intersecting Nodes
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="multipleIterationsCheckbox" 
                    	onclick="Flox.multipleIterationsCheckboxClicked()"> 
                    	Run Multiple Iterations
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="showForceAnimationCheckbox" 
                    	onclick="Flox.showForceAnimationCheckboxClicked()"> 
                    	Show Force Animation
                    </p>
                </div>
                
                <div class="checkboxHolder">
                    <p>
                    	<input type="checkbox" id="editModeCheckbox" checked> 
                    	Edit Mode
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- End sidebar div -->

    <!-- This is the div where the map goes. 
    The "sidebar-map" class was added to make the leaflet sidebar work.
    Can probably be added only if using a leaflet sidebar.-->
    <div id="map" class="sidebar-map"></div>
    
    <!--   Import Flox scripts  -->
    <script src="scripts/Flow.js"></script>
    <script src="scripts/FloxModel.js"></script>
    <script src="scripts/Flox.js"></script>
    <script src="scripts/FlowImporter.js"></script>
    <script src="scripts/MapComponent_Leaflet.js"></script>
    <script src="scripts/MapComponent_d3.js"></script>
    <script src="scripts/FlowLayouter.js"></script>
    <script src="scripts/GeomUtils.js"></script>
	<script src="scripts/dataTable.js"></script> <!-- Table demo --> 
	<script src="scripts/dataTable.js"></script> 
	<script>Flox.initFlox();</script>

</body>
</html>